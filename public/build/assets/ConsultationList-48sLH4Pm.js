import{M as Z,u as ee,p as te,r as s,b as D,R as e,V as X,ae as me,a9 as G,af as de,A as S,m as f,ac as ae,ag as ue,ah as fe,Y as pe,X as Y,ai as he,aj as le,ak as xe,al as be,y as ge,am as Ee,P as we,a8 as J,an as ve,ao as Ne}from"./app-D0VhguGD.js";function ye({selectedId:x,onBack:j,onDeleteSuccess:y,onConsultationViewed:_,className:z=""}){const{id:K}=Z(),c=x||K,p=ee(),{invalidateCache:M}=te(),[W,$]=s.useState(!0),[L,h]=s.useState(null),[o,I]=s.useState(null),[m,P]=s.useState(""),[b,R]=s.useState(!1),[A,v]=s.useState(!1),[E,B]=s.useState(!1),[T,k]=s.useState(!1),[C,a]=s.useState(!1),[r,i]=s.useState(null),[d,g]=s.useState(null),[N,w]=s.useState(null),Q=s.useRef(null),F=s.useRef(null),H=s.useRef(null),U=s.useRef(null);s.useEffect(()=>{c&&O(c)},[c]),s.useEffect(()=>{if(!c)return;const t=setInterval(()=>{document.visibilityState==="visible"&&O(c,!0)},3e4);return()=>clearInterval(t)},[c]),s.useEffect(()=>{re()},[o?.messages]),s.useEffect(()=>{function t(l){F.current&&!F.current.contains(l.target)&&v(!1),H.current&&!H.current.contains(l.target)&&a(!1)}return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]);const se=t=>{const l=t.target.files[0];if(l){if(l.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}i(l),g(URL.createObjectURL(l)),a(!1)}},V=()=>{i(null),d&&(URL.revokeObjectURL(d),g(null)),U.current&&(U.current.value="")},ne=async()=>{a(!1);try{const l=(await D.get(`/parent/consultations/${c}/child-data`)).data.data,n=`Data Kesehatan Anak:
Nama: ${l.name}
Usia: ${ge(l.age_months)}
BB: ${l.weight?l.weight+" kg":"-"}
TB: ${l.height?l.height+" cm":"-"}
LK: ${l.head_circumference?l.head_circumference+" cm":"-"}
Catatan: ${l.notes||"-"}`;P(u=>u?u+`

`+n:n)}catch(t){console.error("Failed to fetch child data:",t),alert("Gagal mengambil data anak.")}},re=()=>{Q.current?.scrollIntoView({behavior:"smooth"})},O=async(t,l=!1)=>{try{l||$(!0),h(null);const n=await D.get(`/parent/consultations/${t}`);I(n.data.data)}catch(n){if(n.response?.status===403)h("Anda tidak memiliki akses untuk melihat konsultasi ini.");else if(n.response?.status===404)h("Konsultasi tidak ditemukan.");else{const u=n.response?.data?.message||"Gagal memuat data konsultasi. Silakan coba lagi.";h(u)}console.error("Consultation fetch error:",n)}finally{l||($(!1),_&&_())}},q=async t=>{if(t.preventDefault(),!(!m.trim()&&!r))try{R(!0),h(null);const l=new FormData;l.append("message",m.trim()||" "),r&&l.append("attachment",r);const n=await D.post(`/parent/consultations/${c}/messages`,l,{headers:{"Content-Type":"multipart/form-data"}});I(u=>({...u,messages:[...u.messages,n.data.data]})),P(""),V(),_&&_()}catch(l){const n=l.response?.data?.message||"Gagal mengirim pesan. Silakan coba lagi.";h(n),console.error("Send message error:",l)}finally{R(!1)}},ie=()=>{v(!1),k(!0)},ce=async()=>{try{B(!0),await D.delete(`/parent/consultations/${c}`),M("consultations_all"),M("consultations_open"),M("consultations_closed"),y?y():p("/dashboard/konsultasi")}catch(t){console.error("Delete error:",t),alert("Gagal menghapus percakapan. Silakan coba lagi."),B(!1),k(!1)}};if(W)return e.createElement("div",{className:"flex flex-1 w-full h-full items-center justify-center bg-slate-50"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.createElement("p",{className:"text-slate-500 font-medium"},"Memuat percakapan...")));if(L&&!o)return e.createElement("div",{className:"flex flex-1 w-full h-full items-center justify-center bg-slate-50"},e.createElement("div",{className:"text-center p-8 bg-white rounded-2xl shadow-lg max-w-md mx-4"},e.createElement("div",{className:"bg-red-100 p-4 rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4"},e.createElement(X,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-xl font-bold text-slate-800 mb-2"},"Terjadi Kesalahan"),e.createElement("p",{className:"text-slate-600 mb-6"},L),e.createElement("div",{className:"flex gap-3 justify-center"},e.createElement("button",{onClick:()=>p("/dashboard/konsultasi"),className:"px-6 py-2.5 bg-slate-200 text-slate-700 rounded-xl hover:bg-slate-300 transition-colors font-medium"},"Kembali"),e.createElement("button",{onClick:()=>O(c),className:"px-6 py-2.5 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-medium"},"Coba Lagi"))));if(!o)return null;const oe=t=>t.sender_role==="ibu";return e.createElement("div",{className:`flex flex-col h-full bg-slate-50 relative overflow-hidden ${z}`},e.createElement("div",{className:"bg-white/80 backdrop-blur-md border-b border-slate-200 px-4 py-3 sticky top-0 z-10 shadow-sm"},e.createElement("div",{className:"flex items-center justify-between max-w-5xl mx-auto w-full"},e.createElement("div",{className:"flex items-center gap-3"},e.createElement("button",{onClick:()=>j?j():p("/dashboard/konsultasi"),className:"p-2 -ml-2 hover:bg-slate-100 rounded-full transition-colors text-slate-600"},e.createElement(me,{className:"w-5 h-5"})),e.createElement("div",{className:"flex items-center gap-3"},e.createElement("div",{className:"relative"},e.createElement("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-100 to-emerald-100 flex items-center justify-center border border-green-200 text-green-700 font-bold text-sm"},o.kader?.name?.substring(0,2).toUpperCase()||"KD"),o.kader?.is_online&&e.createElement("div",{className:"absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-white rounded-full",title:"Kader Online"})),e.createElement("div",null,e.createElement("h2",{className:"text-base font-bold text-slate-800 leading-tight flex items-center gap-2"},o.title),e.createElement("div",{className:"flex items-center gap-1.5 text-xs text-slate-500"},e.createElement("span",{className:"flex items-center gap-1"},e.createElement(X,{className:"w-3 h-3"}),"Kader: ",o.kader?.name||"Petugas",o.kader?.is_online&&e.createElement("span",{className:"text-green-600 font-medium ml-1"},"• Online")),o.status==="open"?e.createElement("span",{className:"flex items-center gap-1 text-green-600 font-medium bg-green-50 px-1.5 py-0.5 rounded-full"},e.createElement("span",{className:"w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"}),"Aktif"):e.createElement("span",{className:"flex items-center gap-1 text-slate-500 bg-slate-100 px-1.5 py-0.5 rounded-full"},e.createElement(G,{className:"w-3 h-3"}),"Selesai"))))),e.createElement("div",{className:"relative",ref:F},e.createElement("button",{onClick:()=>v(!A),className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 hover:text-slate-600 transition-colors"},e.createElement(de,{className:"w-5 h-5"})),e.createElement(S,null,A&&e.createElement(f.div,{initial:{opacity:0,scale:.95,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:10},transition:{duration:.1},className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden z-50"},e.createElement("button",{onClick:ie,className:"w-full px-4 py-3 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2 transition-colors"},e.createElement(ae,{className:"w-4 h-4"}),"Hapus Percakapan")))))),e.createElement("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6 space-y-6 scroll-smooth"},e.createElement("div",{className:"max-w-5xl mx-auto w-full space-y-6"},e.createElement("div",{className:"flex justify-center"},e.createElement("span",{className:"text-xs font-medium text-slate-400 bg-slate-100 px-3 py-1 rounded-full"},new Date(o.created_at).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}))),e.createElement(S,{initial:!1},o.messages.map((t,l)=>{const n=oe(t);return e.createElement(f.div,{key:t.id,initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${n?"justify-end":"justify-start"}`},e.createElement("div",{className:`flex flex-col max-w-[85%] sm:max-w-[70%] ${n?"items-end":"items-start"}`},t.message&&t.message.trim()&&e.createElement("div",{className:`px-5 py-3 shadow-sm relative text-sm leading-relaxed ${n?"bg-blue-600 text-white rounded-2xl rounded-tr-sm":"bg-white text-slate-800 border border-slate-100 rounded-2xl rounded-tl-sm"}`},e.createElement("p",{className:"whitespace-pre-wrap"},t.message)),t.attachment_path&&t.attachment_type==="image"&&e.createElement("div",{className:`${t.message&&t.message.trim()?"mt-2":""} rounded-xl overflow-hidden border border-slate-200 max-w-xs ${n?"ml-auto":"mr-auto"} cursor-pointer hover:opacity-90 transition-opacity`,onClick:()=>w(t.attachment_path)},e.createElement("img",{src:t.attachment_path,alt:"Attachment",className:"w-full h-auto object-cover",loading:"lazy"})),e.createElement("div",{className:`flex items-center gap-1 mt-1.5 text-[10px] font-medium ${n?"text-blue-900/40":"text-slate-400"}`},n&&e.createElement("span",null,"Anda"),!n&&e.createElement("span",null,t.sender_name?.split(" ")[0]),e.createElement("span",null,"•"),e.createElement("span",null,new Date(t.created_at).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"})))))})),e.createElement("div",{ref:Q}))),e.createElement("div",{className:"bg-white border-t border-slate-200 p-4 pb-6 sm:p-4 sticky bottom-0 z-10"},e.createElement("div",{className:"max-w-5xl mx-auto w-full"},o.status==="open"?e.createElement("form",{onSubmit:q,className:"flex items-end gap-2"},e.createElement("div",{className:"relative",ref:H},e.createElement("button",{type:"button",onClick:()=>a(!C),className:`p-3 rounded-full transition-colors mb-1 ${C?"bg-blue-100 text-blue-600":"text-slate-400 hover:text-blue-600 hover:bg-blue-50"}`,title:"Lampirkan"},e.createElement(ue,{className:"w-5 h-5"})),e.createElement(S,null,C&&e.createElement(f.div,{initial:{opacity:0,scale:.9,y:10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:10},className:"absolute bottom-full left-0 mb-2 w-48 bg-white rounded-xl shadow-xl border border-slate-100 overflow-hidden z-20"},e.createElement("button",{type:"button",onClick:()=>U.current?.click(),className:"w-full px-4 py-3 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors"},e.createElement("div",{className:"w-8 h-8 rounded-full bg-purple-100 flex items-center justify-center text-purple-600"},e.createElement(fe,{className:"w-4 h-4"})),e.createElement("span",null,"Kirim Gambar")),e.createElement("button",{type:"button",onClick:ne,className:"w-full px-4 py-3 text-left text-sm text-slate-700 hover:bg-slate-50 flex items-center gap-3 transition-colors"},e.createElement("div",{className:"w-8 h-8 rounded-full bg-blue-100 flex items-center justify-center text-blue-600"},e.createElement(pe,{className:"w-4 h-4"})),e.createElement("span",null,"Data Kesehatan")))),e.createElement("input",{type:"file",ref:U,onChange:se,accept:"image/*",className:"hidden"})),e.createElement("div",{className:"flex-1 relative group",onDragOver:t=>t.preventDefault(),onDrop:t=>{t.preventDefault();const l=t.dataTransfer.files[0];if(l&&l.type.startsWith("image/")){if(l.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}i(l),g(URL.createObjectURL(l))}}},e.createElement(f.div,{className:"absolute inset-0 bg-slate-100 rounded-[24px] pointer-events-none",animate:{backgroundColor:m.trim()||r?"#ffffff":"#f1f5f9",borderColor:m.trim()||r?"#bfdbfe":"transparent",boxShadow:m.trim()||r?"0 4px 6px -1px rgba(59, 130, 246, 0.1), 0 2px 4px -1px rgba(59, 130, 246, 0.06)":"none",borderWidth:"1px"}}),e.createElement("div",{className:"relative flex flex-col"},r&&e.createElement("div",{className:"px-4 pt-4 pb-0"},e.createElement("div",{className:"relative inline-block"},e.createElement("img",{src:d,alt:"Preview",className:"h-20 w-auto rounded-lg border border-slate-200 object-cover"}),e.createElement("button",{type:"button",onClick:V,className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-0.5 hover:bg-red-600 shadow-sm"},e.createElement(Y,{className:"w-3 h-3"})))),e.createElement("textarea",{value:m,onChange:t=>P(t.target.value),placeholder:"Ketik pesan...",rows:"1",className:"w-full bg-transparent border-none focus:ring-0 px-5 py-3 text-slate-800 placeholder:text-slate-400 resize-none max-h-32 min-h-[48px] rounded-[24px]",style:{height:"auto",minHeight:"48px"},onInput:t=>{t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px"},onKeyDown:t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),q(t))},onPaste:t=>{const l=t.clipboardData?.items;if(l){for(let n=0;n<l.length;n++)if(l[n].type.indexOf("image")!==-1){const u=l[n].getAsFile();if(u){if(u.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}i(u),g(URL.createObjectURL(u)),t.preventDefault()}}}},disabled:b}))),e.createElement(f.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",disabled:b||!m.trim()&&!r,className:`w-12 h-12 flex items-center justify-center rounded-full transition-all mb-1 ${m.trim()||r?"bg-blue-600 text-white shadow-lg shadow-blue-200 hover:shadow-blue-300":"bg-slate-100 text-slate-400 cursor-not-allowed"}`},b?e.createElement("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.createElement(he,{className:"w-5 h-5 ml-0.5"}))):e.createElement("div",{className:"bg-slate-50 border border-slate-200 rounded-xl p-4 text-center"},e.createElement("div",{className:"flex items-center justify-center gap-2 text-slate-500 mb-1"},e.createElement(G,{className:"w-5 h-5"}),e.createElement("span",{className:"font-semibold"},"Sesi Selesai")),e.createElement("p",{className:"text-sm text-slate-400"},"Percakapan ini telah ditutup.")))),e.createElement(S,null,T&&e.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},e.createElement(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>!E&&k(!1)}),e.createElement(f.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-2xl shadow-xl w-full max-w-sm relative overflow-hidden"},e.createElement("div",{className:"p-6 text-center"},e.createElement("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(le,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-lg font-bold text-slate-800 mb-2"},"Hapus Percakapan?"),e.createElement("p",{className:"text-slate-500 text-sm mb-6"},"Apakah Anda yakin ingin menghapus percakapan ini? Tindakan ini tidak dapat dibatalkan."),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{onClick:()=>k(!1),disabled:E,className:"flex-1 px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 font-medium transition-colors disabled:opacity-50"},"Batal"),e.createElement("button",{onClick:ce,disabled:E,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 font-medium transition-colors shadow-lg shadow-red-200 disabled:opacity-50 flex items-center justify-center gap-2"},E?e.createElement(e.Fragment,null,e.createElement("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.createElement("span",null,"Menghapus...")):e.createElement("span",null,"Hapus"))))))),N&&xe.createPortal(e.createElement(S,null,e.createElement(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md",onClick:()=>w(null)},e.createElement(f.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},className:"relative max-w-4xl max-h-[90vh] w-full",onClick:t=>t.stopPropagation()},e.createElement("div",{className:"absolute -top-14 right-0 flex items-center gap-2"},e.createElement("a",{href:N,download:!0,target:"_blank",rel:"noopener noreferrer",className:"p-2.5 text-white/80 hover:text-white transition-colors rounded-full hover:bg-white/10 flex items-center gap-2",onClick:t=>t.stopPropagation()},e.createElement(be,{className:"w-6 h-6"}),e.createElement("span",{className:"text-sm font-medium"},"Download")),e.createElement("button",{onClick:()=>w(null),className:"p-2.5 text-white/80 hover:text-white transition-colors rounded-full hover:bg-white/10"},e.createElement(Y,{className:"w-7 h-7"}))),e.createElement("img",{src:N,alt:"Preview",className:"w-full h-auto max-h-[85vh] object-contain rounded-xl shadow-2xl"})))),document.body))}function Ce(){const{id:x}=Z(),[j,y]=s.useState(!0),[_,z]=s.useState(null),[K,c]=s.useState([]),[p,M]=s.useState("all"),[W,$]=s.useState(null),[L,h]=s.useState({show:!1,id:null}),[o,I]=s.useState(!1),[m,P]=s.useState(""),b=ee(),{getCachedData:R,setCachedData:A,invalidateCache:v}=te();s.useEffect(()=>{E(p)},[p]),s.useEffect(()=>{const a=setInterval(()=>{document.visibilityState==="visible"&&E(p,!0)},3e4);return()=>clearInterval(a)},[p]);const E=async(a="all",r=!1)=>{try{r?I(!0):y(!0),z(null);const i=`consultations_${a}`,d=R(i);if(d&&!r){c(d),y(!1);return}const g=a!=="all"?{status:a}:{},w=(await D.get("/parent/consultations",{params:g})).data.data;c(w),A(i,w)}catch(i){const d=i.response?.data?.message||"Gagal memuat data konsultasi. Silakan coba lagi.";z(d),console.error("Consultations fetch error:",i)}finally{r?I(!1):y(!1)}},B=(a,r)=>{a.stopPropagation(),h({show:!0,id:r})},T=async()=>{const a=L.id;if(a)try{$(a),h({show:!1,id:null}),await D.delete(`/parent/consultations/${a}`),c(r=>r.filter(i=>i.id!==a)),v("consultations_all"),v("consultations_open"),v("consultations_closed"),x&&parseInt(x)===a&&b("/dashboard/konsultasi")}catch(r){console.error("Delete error:",r),alert("Gagal menghapus percakapan.")}finally{$(null)}},k=a=>{const r=new Date,i=new Date(a),d=r-i,g=Math.floor(d/6e4),N=Math.floor(d/36e5),w=Math.floor(d/864e5);return g<1?"Baru saja":g<60?`${g}m`:N<24?`${N}j`:w<7?`${w}h`:i.toLocaleDateString("id-ID",{day:"numeric",month:"short"})},C=K.filter(a=>a.title.toLowerCase().includes(m.toLowerCase())||a.kader?.name.toLowerCase().includes(m.toLowerCase()));return j&&K.length===0?e.createElement(Ee,null):e.createElement("div",{className:"flex flex-col h-full w-full bg-white overflow-hidden"},e.createElement(f.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},className:"relative z-50 flex-shrink-0"},e.createElement(we,{title:"Konsultasi",subtitle:"Tanya Ahli Gizi",showProfile:!0})),e.createElement("div",{className:"flex flex-1 h-full overflow-hidden"},e.createElement("div",{className:`flex-col h-full bg-white border-r border-slate-200 md:w-[400px] flex-shrink-0 ${x?"hidden md:flex":"flex w-full"}`},e.createElement("div",{className:"bg-slate-50 border-b border-slate-200 px-4 py-4"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("h1",{className:"text-xl font-bold text-slate-800"},"Konsultasi"),e.createElement("div",{className:"flex items-center gap-2"},o&&e.createElement("div",{className:"w-4 h-4 border-2 border-slate-300 border-t-blue-500 rounded-full animate-spin",title:"Memperbarui..."}),e.createElement("button",{onClick:()=>b("/dashboard/konsultasi/create"),className:"hidden md:block p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors shadow-sm",title:"Buat Konsultasi Baru"},e.createElement(J,{className:"w-5 h-5"})))),e.createElement("div",{className:"relative mb-3"},e.createElement(ve,{className:"absolute left-3 top-2.5 w-4 h-4 text-slate-400"}),e.createElement("input",{type:"text",placeholder:"Cari konsultasi atau kader...",value:m,onChange:a=>P(a.target.value),className:"w-full pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-lg text-sm text-slate-800 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})),e.createElement("div",{className:"flex gap-1 bg-slate-200/50 p-1 rounded-lg w-full"},["all","open","closed"].map(a=>e.createElement("button",{key:a,onClick:()=>M(a),className:`flex-1 py-1.5 rounded-md text-xs font-medium transition-all duration-200 capitalize ${p===a?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`},a==="all"?"Semua":a==="open"?"Aktif":"Selesai")))),e.createElement("div",{className:"flex-1 overflow-y-auto"},j?e.createElement("div",{className:"p-4 space-y-4"},[1,2,3,4].map(a=>e.createElement("div",{key:a,className:"flex gap-3 items-center animate-pulse"},e.createElement("div",{className:"w-12 h-12 bg-slate-200 rounded-full flex-shrink-0"}),e.createElement("div",{className:"flex-1 space-y-2"},e.createElement("div",{className:"h-4 bg-slate-200 rounded w-3/4"}),e.createElement("div",{className:"h-3 bg-slate-200 rounded w-1/2"}))))):C.length===0?e.createElement("div",{className:"flex flex-col items-center justify-center h-64 text-center p-6"},e.createElement("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4"},e.createElement(Ne,{className:"w-8 h-8 text-slate-300"})),e.createElement("p",{className:"text-slate-500 text-sm"},m?"Tidak ada hasil pencarian.":"Belum ada percakapan.")):e.createElement("div",{className:"divide-y divide-slate-100"},C.map(a=>e.createElement("div",{key:a.id,onClick:()=>b(`/dashboard/konsultasi/${a.id}`),className:`group p-4 hover:bg-slate-50 cursor-pointer transition-colors relative ${x&&parseInt(x)===a.id?"bg-blue-50/60 hover:bg-blue-50":""}`},e.createElement("div",{className:"flex items-start gap-3"},e.createElement("div",{className:"relative flex-shrink-0"},e.createElement("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-100 to-indigo-100 flex items-center justify-center text-blue-600 font-bold text-sm border border-blue-200"},a.kader?.name?.substring(0,2).toUpperCase()||"KD"),a.kader?.is_online&&e.createElement("div",{className:"absolute bottom-0 right-0 w-3.5 h-3.5 bg-green-500 border-2 border-white rounded-full",title:"Online"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("div",{className:"flex justify-between items-baseline mb-1"},e.createElement("h3",{className:"text-sm font-bold text-slate-800 truncate pr-2"},a.title),e.createElement("span",{className:"text-[10px] text-slate-400 flex-shrink-0"},k(a.updated_at))),e.createElement("div",{className:"flex justify-between items-end"},e.createElement("p",{className:"text-xs text-slate-500 line-clamp-1 mr-2"},a.last_message?e.createElement(e.Fragment,null,e.createElement("span",{className:"font-medium text-slate-700"},a.last_message.sender_name.split(" ")[0]," :"),a.last_message.attachment_type==="image"?e.createElement("span",{className:"flex items-center gap-1 text-slate-500"},e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},e.createElement("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}),e.createElement("circle",{cx:"9",cy:"9",r:"2"}),e.createElement("path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"})),"Foto"):" "+a.last_message.message):e.createElement("span",{className:"italic text-slate-400"},"Belum ada pesan")),a.unread_count>0?e.createElement("div",{className:"flex items-center justify-center min-w-[20px] h-5 px-1.5 rounded-full bg-green-500 flex-shrink-0",title:`${a.unread_count} pesan belum dibaca`},e.createElement("span",{className:"text-[10px] font-bold text-white"},a.unread_count)):a.status==="closed"?e.createElement(G,{className:"w-3.5 h-3.5 text-slate-400 flex-shrink-0",title:"Selesai"}):null))),e.createElement("button",{onClick:r=>B(r,a.id),className:"absolute right-12 top-1/2 -translate-y-1/2 p-1.5 text-slate-400 hover:text-red-600 bg-white/90 hover:bg-red-50 rounded-full opacity-0 group-hover:opacity-100 transition-all shadow-sm border border-slate-100 hover:border-red-100 z-10",title:"Hapus"},e.createElement(ae,{className:"w-4 h-4"})))))),e.createElement("button",{onClick:()=>b("/dashboard/konsultasi/create"),className:"md:hidden fixed bottom-24 right-6 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 transition-all z-40 flex items-center justify-center active:scale-95",title:"Buat Konsultasi Baru"},e.createElement(J,{className:"w-8 h-8"}))),e.createElement("div",{className:`flex-1 flex-col h-full bg-slate-50 relative ${x?"flex":"hidden md:flex"}`},e.createElement("div",{className:"absolute inset-0 opacity-[0.06] pointer-events-none",style:{backgroundImage:'url("https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png")'}}),x?e.createElement(ye,{selectedId:x,onBack:()=>b("/dashboard/konsultasi"),onDeleteSuccess:()=>{b("/dashboard/konsultasi"),E(p)},onConsultationViewed:()=>{E(p,!0)},className:"h-full z-10"}):e.createElement("div",{className:"flex-1 flex flex-col items-center justify-center text-center p-8 z-10"},e.createElement("div",{className:"w-80 h-80 mb-6 relative"},e.createElement("div",{className:"absolute inset-0 bg-blue-100/50 rounded-full blur-3xl opacity-50 animate-pulse"}),e.createElement("img",{src:"/images/chat-placeholder.png?v=2",alt:"Select Chat",className:"w-full h-full object-contain relative z-10 drop-shadow-2xl"})),e.createElement("h2",{className:"text-3xl font-bold text-slate-800 mb-3"},"NutriLogic Web"),e.createElement("p",{className:"text-slate-500 max-w-md text-lg leading-relaxed"},"Kirim dan terima pesan konsultasi dengan kader kesehatan secara real-time. Pilih percakapan di sebelah kiri untuk memulai."),e.createElement("div",{className:"mt-8 flex items-center gap-2 text-slate-400 text-sm font-medium bg-white/50 px-4 py-2 rounded-full border border-slate-100"},e.createElement("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.createElement("span",null,"Status Kader Real-time")))),e.createElement(S,null,L.show&&e.createElement("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4"},e.createElement(f.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-black/40 backdrop-blur-sm",onClick:()=>h({show:!1,id:null})}),e.createElement(f.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-2xl shadow-xl w-full max-w-sm relative overflow-hidden z-50"},e.createElement("div",{className:"p-6 text-center"},e.createElement("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(le,{className:"w-8 h-8 text-red-600"})),e.createElement("h3",{className:"text-lg font-bold text-slate-800 mb-2"},"Hapus Percakapan?"),e.createElement("p",{className:"text-slate-500 text-sm mb-6"},"Apakah Anda yakin ingin menghapus percakapan ini? Tindakan ini tidak dapat dibatalkan."),e.createElement("div",{className:"flex gap-3"},e.createElement("button",{onClick:()=>h({show:!1,id:null}),className:"flex-1 px-4 py-2.5 bg-slate-100 text-slate-700 rounded-xl hover:bg-slate-200 font-medium transition-colors"},"Batal"),e.createElement("button",{onClick:T,className:"flex-1 px-4 py-2.5 bg-red-600 text-white rounded-xl hover:bg-red-700 font-medium transition-colors shadow-lg shadow-red-200"},"Hapus"))))))))}export{Ce as default};
